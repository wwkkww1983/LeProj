@model ZdflCount.Models.ScheduleOrder

@{
    ViewBag.Title = "新建施工单";
    var errorMsg = "";
    if (ViewData["error"] != null)
    {
        errorMsg = ViewData["error"].ToString();
    }
}

<h2>@ViewBag.Title</h2>

<script >
    function CheckProductCount(createForm) {
        var t = document.getElementById('orderCount').innerHTML;
        var c = createForm.Schedules_ProductCount.value;
        if (Number(t) < Number(c)) {
            window.alert("分派数量超过订单剩余总数");
            return false;
        }
        return true;
        
    }
</script>

@Html.Partial("_OrderCountPartial")

@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>输入施工单信息</legend>
        
        @Html.Hidden("Schedules.OrderId", Model.Orders.OrderId)
        @Html.Hidden("Schedules.OrderNumber", Model.Orders.OrderNumber)

        <div class="error-message-ur-fieldset">
            @errorMsg
        </div>
        <div class="editor-label">
            @Html.LabelFor(model => model.Schedules.CreatorName)
        </div>
        <div class="editor-field">
            ：@ViewData["CreatorName"]
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Schedules.ProductCount)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Schedules.ProductCount)
            @Html.ValidationMessageFor(model => model.Schedules.ProductCount)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Schedules.DetailInfo)
        </div>
        <div class="editor-field">
            @Html.TextAreaFor(model => model.Schedules.DetailInfo, new { rows = "8", style = "width:99%" })
        </div>        

        <div class="editor-label">
            @Html.LabelFor(model => model.Schedules.NoticeInfo)
        </div>
        <div class="editor-field">
            @Html.TextAreaFor(model => model.Schedules.NoticeInfo, new { rows = "8", style = "width:99%" })
        </div>
        <p>
            <input type="submit" value="保存新施工单" onclick="return CheckProductCount(this.form)" />
        </p>
    </fieldset>
}

<div class="left-outof-table">
    @Html.ActionLink("返回施工单列表", "Index",  new {id = Model.Orders.OrderId})
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
